<?xml version="1.0" encoding="utf-8" ?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <RunBuildTasks Condition="'$(RunBuildTasks)' == ''">false</RunBuildTasks>
    <VersionFile Condition="'$(VersionFile)' == ''">Properties/Version.txt</VersionFile>
    <InputFile Condition="'$(InputFile)' == ''">Properties/GlobalAssemblyInfo.cs</InputFile>
    <OutputFile Condition="'$(OutputFile)' == ''">$(InputFile)</OutputFile>
  </PropertyGroup>

  <Target Name="ExecRunBuildTasks" BeforeTargets="BeforeBuild">
    <Exec Command="&quot;$(MSBuildBinPath)\MSBuild.exe&quot; /t:RunBuildTasks /p:RunBuildTasks=true /p:Configuration=$(Configuration) &quot;$(ProjectDir)$(ProjectFileName)&quot;" />
  </Target>

  <Target Name="RunBuildTasks" Condition="$(RunBuildTasks)">
    <CallTarget Targets="UpdateVersion" />
  </Target>

  <UsingTask TaskName="UpdateAssemblyVersion" AssemblyFile="$(ProjectDir)..\Micser.BuildTasks\bin\$(Configuration)\Micser.BuildTasks.dll" />

  <Target Name="UpdateVersion">
    <UpdateAssemblyVersion InputFileName="$(InputFile)" OutputFileName="$(OutputFile)" VersionFileName="$(VersionFile)" />
  </Target>
</Project>
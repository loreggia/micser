<?xml version="1.0" encoding="utf-8"?>
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
</auto-generated>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="6fe30b47-2577-43ad-9095-1861ca25889c" Name="Micser" Language="1033" Codepage="Windows-1252" Version="1.0.0.0" UpgradeCode="6fe30b47-2577-43ad-9095-1861ba25889b" Manufacturer="lucas">
    <Package InstallerVersion="200" Compressed="yes" SummaryCodepage="Windows-1252" Languages="1033" />
    <Media Id="1" Cabinet="Micser.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder" Name="ProgramFilesFolder">
        <Directory Id="INSTALLDIR" Name="Micser">
          <Directory Id="INSTALLDIR.App" Name="App">

            <Component Id="Component.CommonServiceLocator.dll_1043268448" Guid="6fe30b47-2577-43ad-9095-18617350c591">
              <File Id="CommonServiceLocator.dll_1043268448" Source="App\CommonServiceLocator.dll" />
            </Component>

            <Component Id="Component.CSCore.dll_1469794440" Guid="6fe30b47-2577-43ad-9095-1861d8f6cdbf">
              <File Id="CSCore.dll_1469794440" Source="App\CSCore.dll" />
            </Component>

            <Component Id="Component.Hardcodet.Wpf.TaskbarNotification.dll_1816670365" Guid="6fe30b47-2577-43ad-9095-186110e2af56">
              <File Id="Hardcodet.Wpf.TaskbarNotification.dll_1816670365" Source="App\Hardcodet.Wpf.TaskbarNotification.dll" />
            </Component>

            <Component Id="Component.Micser.App.exe_1064145124" Guid="6fe30b47-2577-43ad-9095-1861236d614d">
              <File Id="Micser.App.exe_1064145124" Source="App\Micser.App.exe" />
            </Component>

            <Component Id="Component.Micser.App.exe.config_222573622" Guid="6fe30b47-2577-43ad-9095-186112ef97e3">
              <File Id="Micser.App.exe.config_222573622" Source="App\Micser.App.exe.config" />
            </Component>

            <Component Id="Component.Micser.App.Infrastructure.dll_1914818985" Guid="6fe30b47-2577-43ad-9095-186150b8d61a">
              <File Id="Micser.App.Infrastructure.dll_1914818985" Source="App\Micser.App.Infrastructure.dll" />
            </Component>

            <Component Id="Component.Micser.Common.dll_1917031555" Guid="6fe30b47-2577-43ad-9095-186182aa0600">
              <File Id="Micser.Common.dll_1917031555" Source="App\Micser.Common.dll" />
            </Component>

            <Component Id="Component.Micser.Engine.exe_2060560028" Guid="6fe30b47-2577-43ad-9095-18612ed22555">
              <File Id="Micser.Engine.exe_2060560028" Source="App\Micser.Engine.exe" />
            </Component>

            <Component Id="Component.Micser.Engine.exe.config_1433426393" Guid="6fe30b47-2577-43ad-9095-18617bba3204">
              <File Id="Micser.Engine.exe.config_1433426393" Source="App\Micser.Engine.exe.config" />
            </Component>

            <Component Id="Component.Micser.Engine.Infrastructure.dll_1104853497" Guid="6fe30b47-2577-43ad-9095-1861329065dc">
              <File Id="Micser.Engine.Infrastructure.dll_1104853497" Source="App\Micser.Engine.Infrastructure.dll" />
            </Component>

            <Component Id="Component.Micser.Plugins.Main.dll_703895423" Guid="6fe30b47-2577-43ad-9095-1861e4a58458">
              <File Id="Micser.Plugins.Main.dll_703895423" Source="App\Micser.Plugins.Main.dll" />
            </Component>

            <Component Id="Component.Nancy.dll_735301589" Guid="6fe30b47-2577-43ad-9095-18616d65b58c">
              <File Id="Nancy.dll_735301589" Source="App\Nancy.dll" />
            </Component>

            <Component Id="Component.Nancy.Hosting.Self.dll_2106079591" Guid="6fe30b47-2577-43ad-9095-18610a11a4c3">
              <File Id="Nancy.Hosting.Self.dll_2106079591" Source="App\Nancy.Hosting.Self.dll" />
            </Component>

            <Component Id="Component.Nancy.Serialization.JsonNet.dll_1259959754" Guid="6fe30b47-2577-43ad-9095-18616cb1114c">
              <File Id="Nancy.Serialization.JsonNet.dll_1259959754" Source="App\Nancy.Serialization.JsonNet.dll" />
            </Component>

            <Component Id="Component.Newtonsoft.Json.dll_2068862308" Guid="6fe30b47-2577-43ad-9095-18611d1d8f99">
              <File Id="Newtonsoft.Json.dll_2068862308" Source="App\Newtonsoft.Json.dll" />
            </Component>

            <Component Id="Component.NLog.dll_1128448916" Guid="6fe30b47-2577-43ad-9095-18617167c484">
              <File Id="NLog.dll_1128448916" Source="App\NLog.dll" />
            </Component>

            <Component Id="Component.Prism.dll_717679119" Guid="6fe30b47-2577-43ad-9095-18610cd7e311">
              <File Id="Prism.dll_717679119" Source="App\Prism.dll" />
            </Component>

            <Component Id="Component.Prism.Unity.Wpf.dll_1974939844" Guid="6fe30b47-2577-43ad-9095-186151ba92f2">
              <File Id="Prism.Unity.Wpf.dll_1974939844" Source="App\Prism.Unity.Wpf.dll" />
            </Component>

            <Component Id="Component.Prism.Wpf.dll_953004500" Guid="6fe30b47-2577-43ad-9095-18613c4424ac">
              <File Id="Prism.Wpf.dll_953004500" Source="App\Prism.Wpf.dll" />
            </Component>

            <Component Id="Component.System.Configuration.ConfigurationManager.dll_1048326755" Guid="6fe30b47-2577-43ad-9095-1861cb803ffa">
              <File Id="System.Configuration.ConfigurationManager.dll_1048326755" Source="App\System.Configuration.ConfigurationManager.dll" />
            </Component>

            <Component Id="Component.System.Windows.Interactivity.dll_716508900" Guid="6fe30b47-2577-43ad-9095-186172e20691">
              <File Id="System.Windows.Interactivity.dll_716508900" Source="App\System.Windows.Interactivity.dll" />
            </Component>

            <Component Id="Component.Unity.Abstractions.dll_1566875426" Guid="6fe30b47-2577-43ad-9095-1861cba748b2">
              <File Id="Unity.Abstractions.dll_1566875426" Source="App\Unity.Abstractions.dll" />
            </Component>

            <Component Id="Component.Unity.Configuration.dll_1212215679" Guid="6fe30b47-2577-43ad-9095-1861ebf3b396">
              <File Id="Unity.Configuration.dll_1212215679" Source="App\Unity.Configuration.dll" />
            </Component>

            <Component Id="Component.Unity.Container.dll_487022113" Guid="6fe30b47-2577-43ad-9095-18611f206fef">
              <File Id="Unity.Container.dll_487022113" Source="App\Unity.Container.dll" />
            </Component>

            <Component Id="Component.Unity.Interception.Configuration.dll_2097068512" Guid="6fe30b47-2577-43ad-9095-18619468e27a">
              <File Id="Unity.Interception.Configuration.dll_2097068512" Source="App\Unity.Interception.Configuration.dll" />
            </Component>

            <Component Id="Component.Unity.Interception.dll_288550111" Guid="6fe30b47-2577-43ad-9095-1861f52e5560">
              <File Id="Unity.Interception.dll_288550111" Source="App\Unity.Interception.dll" />
            </Component>

            <Component Id="Component.Unity.RegistrationByConvention.dll_839282795" Guid="6fe30b47-2577-43ad-9095-18615cbe1055">
              <File Id="Unity.RegistrationByConvention.dll_839282795" Source="App\Unity.RegistrationByConvention.dll" />
            </Component>

            <Component Id="Component.Unity.ServiceLocation.dll_1183268791" Guid="6fe30b47-2577-43ad-9095-1861af185b2b">
              <File Id="Unity.ServiceLocation.dll_1183268791" Source="App\Unity.ServiceLocation.dll" />
            </Component>

          </Directory>

          <Directory Id="INSTALLDIR.Driver" Name="Driver">

            <Component Id="Component.Micser.Vac.Package.cer_837308400" Guid="6fe30b47-2577-43ad-9095-18618fc4e83f">
              <File Id="Micser.Vac.Package.cer_837308400" Source="Driver\Win32\Micser.Vac.Package.cer" />
            </Component>

            <Directory Id="INSTALLDIR.Driver.Micser.Vac.Package" Name="Micser.Vac.Package">

              <Component Id="Component.micser.vac.driver.cat_1881001242" Guid="6fe30b47-2577-43ad-9095-186114e90deb">
                <File Id="micser.vac.driver.cat_1881001242" Source="Driver\Win32\Micser.Vac.Package\micser.vac.driver.cat" />
              </Component>

              <Component Id="Component.Micser.Vac.Driver.inf_1342068543" Guid="6fe30b47-2577-43ad-9095-18612d3550ec">
                <File Id="Micser.Vac.Driver.inf_1342068543" Source="Driver\Win32\Micser.Vac.Package\Micser.Vac.Driver.inf" />
              </Component>

              <Component Id="Component.Micser.Vac.Driver.sys_568371380" Guid="6fe30b47-2577-43ad-9095-18617a6b0785">
                <File Id="Micser.Vac.Driver.sys_568371380" Source="Driver\Win32\Micser.Vac.Package\Micser.Vac.Driver.sys" />
              </Component>

            </Directory>
          </Directory>
        </Directory>
      </Directory>

      <Directory Id="ProgramMenuFolder" Name="ProgramMenuFolder">
        <Directory Id="ProgramMenuFolder.Micser" Name="Micser">

          <Component Id="Component.Micser__" Guid="6fe30b47-2577-43ad-9095-186147c48558">
            <Shortcut Id="ProgramMenuFolder.Micser.Micser__" WorkingDirectory="ProgramMenuFolder.Micser.Micser__.WorkDir" Target="[INSTALLDIR]\App\Micser.App.exe" Name="Micser.lnk" />

            <CreateFolder />
            <RemoveFolder Id="ProgramMenuFolder.Micser" On="uninstall" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Uninstall_Micser" Guid="6fe30b47-2577-43ad-9095-18615c5cc10d">
            <Shortcut Id="ProgramMenuFolder.Micser.Uninstall_Micser" WorkingDirectory="SystemFolder" Target="[SystemFolder]msiexec.exe" Arguments="/x [ProductCode]" Name="Uninstall Micser.lnk" />

            <CreateFolder />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

        </Directory>
      </Directory>
    </Directory>

    <UI />

    <UI>
      <EmbeddedUI Id="WixSharp_EmbeddedUI_Asm" SourceFile="..\..\src\Micser.Setup\WixSharp.UI.CA.dll" />
    </UI>

    <CustomAction Id="WixSharp_InitRuntime_Action" BinaryKey="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_InitRuntime_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_CancelRequestHandler_Props" Property="CancelRequestHandler" Value="UpgradeCode=[UpgradeCode];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode]" />
    <CustomAction Id="CancelRequestHandler" BinaryKey="WixSharp_InitRuntime_Action_File" DllEntry="CancelRequestHandler" Return="check" Impersonate="no" Execute="deferred" />

    <Binary Id="WixSharp_InitRuntime_Action_File" SourceFile="..\..\src\Micser.Setup\WixSharp.CA.dll" />
    <Binary Id="WixSharp_UIText" SourceFile="..\..\src\Micser.Setup\Micser.wxl" />
    <Binary Id="WixSharp_LicenceFile" SourceFile="..\..\src\Micser.Setup\Micser.licence.rtf" />
    <Binary Id="WixUI_Bmp_Dialog" SourceFile="..\..\src\Micser.Setup\Micser.dialog_bmp.png" />
    <Binary Id="WixUI_Bmp_Banner" SourceFile="..\..\src\Micser.Setup\Micser.dialog_banner.png" />

    <UIRef Id="WixUI_ErrorProgressText" />

    <Property Id="WixSharp_UI_INSTALLDIR" Value="INSTALLDIR" />
    <Property Id="UAC_REVEALER_ENABLED" Value="true" />
    <Property Id="UAC_WARNING" Value="Please wait for UAC prompt to appear.&#xD;&#xA;&#xD;&#xA;If it appears minimized then activate it from the taskbar." />
    <Property Id="WixSharp_InstallDialogs" Value="WixSharp.UI, Version=1.9.3.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.WelcomeDialog&#xA;WixSharp.UI, Version=1.9.3.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.InstallDirDialog&#xA;WixSharp.UI, Version=1.9.3.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.ProgressDialog&#xA;WixSharp.UI, Version=1.9.3.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.ExitDialog" />
    <Property Id="WixSharp_ModifyDialogs" Value="WixSharp.UI, Version=1.9.3.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.MaintenanceTypeDialog&#xA;WixSharp.UI, Version=1.9.3.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.ProgressDialog&#xA;WixSharp.UI, Version=1.9.3.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.ExitDialog" />
    <Property Id="ProgramMenuFolder.Micser.Micser__.WorkDir" Value="INSTALLDIR\App\" />

    <Feature Id="Complete" Title="Complete" Absent="allow" Level="1">
      <ComponentRef Id="Component.CommonServiceLocator.dll_1043268448" />
      <ComponentRef Id="Component.CSCore.dll_1469794440" />
      <ComponentRef Id="Component.Hardcodet.Wpf.TaskbarNotification.dll_1816670365" />
      <ComponentRef Id="Component.Micser.App.exe_1064145124" />
      <ComponentRef Id="Component.Micser.App.exe.config_222573622" />
      <ComponentRef Id="Component.Micser.App.Infrastructure.dll_1914818985" />
      <ComponentRef Id="Component.Micser.Common.dll_1917031555" />
      <ComponentRef Id="Component.Micser.Engine.exe_2060560028" />
      <ComponentRef Id="Component.Micser.Engine.exe.config_1433426393" />
      <ComponentRef Id="Component.Micser.Engine.Infrastructure.dll_1104853497" />
      <ComponentRef Id="Component.Micser.Plugins.Main.dll_703895423" />
      <ComponentRef Id="Component.Nancy.dll_735301589" />
      <ComponentRef Id="Component.Nancy.Hosting.Self.dll_2106079591" />
      <ComponentRef Id="Component.Nancy.Serialization.JsonNet.dll_1259959754" />
      <ComponentRef Id="Component.Newtonsoft.Json.dll_2068862308" />
      <ComponentRef Id="Component.NLog.dll_1128448916" />
      <ComponentRef Id="Component.Prism.dll_717679119" />
      <ComponentRef Id="Component.Prism.Unity.Wpf.dll_1974939844" />
      <ComponentRef Id="Component.Prism.Wpf.dll_953004500" />
      <ComponentRef Id="Component.System.Configuration.ConfigurationManager.dll_1048326755" />
      <ComponentRef Id="Component.System.Windows.Interactivity.dll_716508900" />
      <ComponentRef Id="Component.Unity.Abstractions.dll_1566875426" />
      <ComponentRef Id="Component.Unity.Configuration.dll_1212215679" />
      <ComponentRef Id="Component.Unity.Container.dll_487022113" />
      <ComponentRef Id="Component.Unity.Interception.Configuration.dll_2097068512" />
      <ComponentRef Id="Component.Unity.Interception.dll_288550111" />
      <ComponentRef Id="Component.Unity.RegistrationByConvention.dll_839282795" />
      <ComponentRef Id="Component.Unity.ServiceLocation.dll_1183268791" />
      <ComponentRef Id="Component.Micser.Vac.Package.cer_837308400" />
      <ComponentRef Id="Component.micser.vac.driver.cat_1881001242" />
      <ComponentRef Id="Component.Micser.Vac.Driver.inf_1342068543" />
      <ComponentRef Id="Component.Micser.Vac.Driver.sys_568371380" />
      <ComponentRef Id="Component.Micser__" />
      <ComponentRef Id="Component.Uninstall_Micser" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Action="WixSharp_InitRuntime_Action" Before="AppSearch"> (1) </Custom>
      <Custom Action="Set_CancelRequestHandler_Props" Before="InstallFinalize" />
      <Custom Action="CancelRequestHandler" After="Set_CancelRequestHandler_Props"> (NOT (REMOVE="ALL")) </Custom>
    </InstallExecuteSequence>

  </Product>
</Wix>

